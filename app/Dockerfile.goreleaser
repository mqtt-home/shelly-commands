# syntax=docker/dockerfile:1.19

# Final stage - only for the binary
FROM gcr.io/distroless/static:nonroot

WORKDIR /

# Copy the pre-built binary from GoReleaser
COPY shelly-commands /shelly-commands

# Copy the frontend build files
COPY web/dist/ /web/dist/

# Use non-root user (distroless already provides this)
USER nonroot:nonroot

ENTRYPOINT ["/shelly-commands", "/var/lib/shelly-commands/config.json"]
